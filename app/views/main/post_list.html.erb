<center>
  <h3 style="font-family:Avenir Book;"># <%=@id%></h3>
</center>

<script>
  $(function() {
    var swiper = new Swiper('.post-slider', {
      direction: 'horizontal',
      speed: 300,
      resistance: true,
      resistanceRatio: 1
    });
  });
</script>

<script>
  function matrixToArray(str) {
    return str.match(/(-?[0-9\.]+)/g);
  }
</script>

<% @list.get.reverse.take(10).each do |i| %>
  <div class="post-slider swiper-container" >
    <div id="<%=i["objectId"]%>_card" class="post_card swiper-wrapper">
      <div id="<%=i["objectId"]%>_left"class="slide-left slide-center swiper-slide"><%=i["left"]["content"]%></div>
      <div id="<%=i["objectId"]%>" class="slide-topic swiper-slide">
        <a href="/main/post_content/<%=i["objectId"]%>">
          <div class="post_img picture" style="width:100%;height:100%;background-image:url('<%=i["image_url"]%>');background-size:cover;background-repeat:no-repeat;background-position: center center;">
            <div class="blurry-box" style="background:url('http://cfs6.blog.daum.net/image/14/blog/2008/03/11/23/23/47d695f9411f3&filename=%EB%AC%B4%EB%8A%AC%EC%97%86%EB%8A%94%EA%B2%80%EC%A0%95%EC%83%89%EB%B0%B0%EA%B2%BD.jpg')"></div>
            <div class="text" style="text-align:center;width:100%">
              <span style="font-size:15px;color:white"><%=i["subject"]%></span>
            </div>
          </div>
        </a>
        <div class="post_title slide-center">topic</div>
        <div class="post_tag"></div>
      </div>
      <div id="<%=i["objectId"]%>_right" class="slide-right slide-center swiper-slide"><%=i["right"]["content"]%></div>
    </div>
  </div>

  <script>
    $(function() {
      var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;
      console.log(width);
      $('#<%=i["objectId"]%>_card').css("transform", "translate3d(-"+width+"px, 0px, 0px)");
      $('#<%=i["objectId"]%>_card').on('transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd', 
        function() {
          var a = $('#<%=i["objectId"]%>_card').css("transform");
          var arrA = matrixToArray(a);
          var x = (arrA[4] == 0) ? Number(arrA[4]) : -arrA[4];
          console.log(x);
          var content;
          var confirm_option;
          
          if (width > x) {
            confirm_option = {
              title: 'Swing Vote',
              buttons: { '확인': true, '취소': false },
              focus: 0,
              submit:function(e,v,m,f){ 
          		  if (v === true) {
          		    console.log("left - true");
                  location.href = '/main/post_content/<%=i["objectId"]%>'
          		  } else if (v === false) {
          		    console.log("left - false");
                  $('#<%=i["objectId"]%>_card').css("transform", "translate3d(-"+width+"px, 0px, 0px)");
          		  }
        		  }
            };
            content = $("#<%=i["objectId"]%>_left").html();
            $.prompt(content, confirm_option);
          } else if(width < x) {
            confirm_option = {
              title: 'Swing Vote',
              buttons: { '확인': true, '취소': false },
              focus: 0,
              submit:function(e,v,m,f){ 
          		  if (v === true) {
          		    console.log("right - true");
                  location.href = '/main/post_content/<%=i["objectId"]%>'
                  //document.location = 'js://code'
                  //어떤 태그 post_list에서 어떤 글을 선택하고 투표를 했는지
          		  } else if (v === false) {
          		    console.log("right - false");
                  $('#<%=i["objectId"]%>_card').css("transform", "translate3d(-"+width+"px, 0px, 0px)");
          		  }
        		  }
            };
            content = $("#<%=i["objectId"]%>_right").html();
            $.prompt(content, confirm_option);
          }
      });
    });
  </script>
<% end %>
